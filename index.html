<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>X_FAZI TEXTURE MAKER</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#040404;--s1:#080808;--s2:#0d0d0d;--s3:#131313;--s4:#191919;
  --b1:#161616;--b2:#202020;--b3:#2c2c2c;--b4:#383838;
  --text:#c8c8c8;--dim:#2e2e2e;--mid:#4a4a4a;--lo:#777;--hi:#fff;
  --mc:'Press Start 2P',monospace;--mono:'Share Tech Mono',monospace;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;overflow:hidden}
body{background:var(--bg);color:var(--text);font-family:var(--mono);display:flex;flex-direction:column;font-size:12px}
::-webkit-scrollbar{width:3px;height:3px}
::-webkit-scrollbar-thumb{background:var(--b3)}
::-webkit-scrollbar-track{background:transparent}
#intro{
  position:fixed;inset:0;background:#000;z-index:99999;
  display:flex;align-items:center;justify-content:center;
  overflow:hidden;
}
#intro.out{animation:introOut .8s cubic-bezier(.55,0,1,.45) forwards}
@keyframes introOut{
  0%{opacity:1;transform:scale(1)}
  40%{opacity:1;transform:scale(1.08)}
  100%{opacity:0;transform:scale(1.12)}
}
#intro::before{
  content:'';position:absolute;inset:0;
  background:repeating-linear-gradient(0deg,rgba(255,255,255,.015) 0px,rgba(255,255,255,.015) 1px,transparent 1px,transparent 3px);
  pointer-events:none;z-index:1;
  animation:scanScroll 6s linear infinite;
}
@keyframes scanScroll{from{background-position:0 0}to{background-position:0 200px}}
.ig{
  position:absolute;inset:0;
  background-image:
    linear-gradient(rgba(255,255,255,.03) 1px,transparent 1px),
    linear-gradient(90deg,rgba(255,255,255,.03) 1px,transparent 1px);
  background-size:40px 40px;
  animation:igPulse 3s ease-in-out infinite;
}
@keyframes igPulse{0%,100%{opacity:.3}50%{opacity:.8}}
.ic{position:absolute}
.ic span{
  position:absolute;width:28px;height:28px;
  border-color:#222;border-style:solid;
  opacity:0;animation:icShow .4s ease forwards;
}
.ic span:nth-child(1){top:24px;left:24px;border-width:1px 0 0 1px;animation-delay:.1s}
.ic span:nth-child(2){top:24px;right:24px;border-width:1px 1px 0 0;animation-delay:.15s}
.ic span:nth-child(3){bottom:24px;left:24px;border-width:0 0 1px 1px;animation-delay:.2s}
.ic span:nth-child(4){bottom:24px;right:24px;border-width:0 1px 1px 0;animation-delay:.25s}
@keyframes icShow{to{opacity:1}}
.ilines{
  position:absolute;top:50%;left:0;right:0;
  display:flex;flex-direction:column;align-items:center;
  transform:translateY(-50%);
}
.iline-h{
  height:1px;background:linear-gradient(90deg,transparent,#1a1a1a,transparent);
  width:0;
}
.iline-h.t{animation:lineW .6s ease .3s forwards;margin-bottom:70px}
.iline-h.b{animation:lineW .6s ease .35s forwards;margin-top:70px}
@keyframes lineW{to{width:500px}}
.imain{
  position:relative;z-index:2;
  display:flex;flex-direction:column;align-items:center;
}
.ipre{
  font-family:var(--mc);font-size:8px;letter-spacing:10px;
  color:var(--mid);
  opacity:0;transform:translateY(-6px);
  animation:iUp .5s ease .4s forwards;
  margin-bottom:18px;
}
@keyframes iUp{to{opacity:1;transform:translateY(0)}}
.ititle{
  font-family:var(--mc);
  font-size:clamp(24px,4vw,44px);
  letter-spacing:6px;
  color:var(--hi);
  display:flex;align-items:center;
  position:relative;
  min-height:52px;
}
.ich{
  display:inline-block;
  opacity:0;transform:translateY(14px) scale(.6) rotateX(45deg);
  animation:chIn .18s cubic-bezier(.34,1.6,.64,1) forwards;
}
@keyframes chIn{to{opacity:1;transform:translateY(0) scale(1) rotateX(0)}}
.ich.sep{color:#2a2a2a}
.icur{
  display:inline-block;width:3px;height:40px;
  background:var(--hi);margin-left:3px;vertical-align:middle;
  animation:cur .65s step-end infinite;
  box-shadow:0 0 8px rgba(255,255,255,.6);
}
@keyframes cur{0%,100%{opacity:1}50%{opacity:0}}
.isub{
  font-family:var(--mc);font-size:7px;
  letter-spacing:6px;color:var(--mid);
  margin-top:14px;
  opacity:0;animation:iUp .5s ease 2.1s forwards;
}
.ibar{
  margin-top:24px;
  width:0;height:1px;
  background:linear-gradient(90deg,transparent 0%,#2a2a2a 20%,#555 50%,#2a2a2a 80%,transparent 100%);
  animation:iBarW .9s ease 2.2s forwards;
}
@keyframes iBarW{to{width:340px}}
.ibtm{
  display:flex;gap:24px;margin-top:14px;
  opacity:0;animation:iUp .4s ease 2.8s forwards;
}
.ibtm-item{font-size:8px;color:var(--dim);letter-spacing:3px}
.iskip{
  position:absolute;bottom:30px;right:36px;
  font-family:var(--mc);font-size:6px;letter-spacing:2px;
  color:var(--mid);cursor:pointer;
  border:1px solid #1e1e1e;padding:7px 14px;background:rgba(0,0,0,.6);
  transition:all .2s;
  opacity:0;animation:iUp .4s ease 2.5s forwards;
}
.iskip:hover{color:var(--hi);border-color:var(--b3);background:var(--s2)}
.ititle.glitch{animation:glitch .15s steps(2) forwards}
@keyframes glitch{
  0%{transform:translate(0)}
  25%{transform:translate(-2px,1px);filter:hue-rotate(90deg)}
  50%{transform:translate(2px,-1px)}
  75%{transform:translate(-1px,2px);filter:hue-rotate(-90deg)}
  100%{transform:translate(0)}
}
#tut{
  position:fixed;inset:0;background:rgba(0,0,0,.97);
  z-index:9998;display:none;align-items:center;justify-content:center;
}
#tut.on{display:flex;animation:tIn .3s ease}
@keyframes tIn{from{opacity:0}to{opacity:1}}
.tw{
  width:800px;max-width:97vw;max-height:92vh;
  background:var(--s1);border:1px solid var(--b3);
  display:flex;flex-direction:column;overflow:hidden;
  animation:twIn .4s cubic-bezier(.34,1.2,.64,1);
}
@keyframes twIn{from{transform:scale(.95) translateY(10px);opacity:0}to{transform:none;opacity:1}}
.thd{
  display:flex;align-items:center;justify-content:space-between;
  padding:14px 22px;background:var(--s2);border-bottom:1px solid var(--b2);
  flex-shrink:0;
}
.thd-t{font-family:var(--mc);font-size:7px;color:var(--hi);letter-spacing:2px}
.thd-x{
  width:26px;height:26px;background:var(--s3);border:1px solid var(--b2);
  color:var(--mid);cursor:pointer;font-size:14px;
  display:flex;align-items:center;justify-content:center;transition:all .1s;
}
.thd-x:hover{color:var(--hi);border-color:var(--b4)}
.tprog{height:2px;background:var(--b1);flex-shrink:0;position:relative;overflow:hidden}
.tpfill{height:100%;background:var(--hi);transition:width .5s cubic-bezier(.34,1.2,.64,1)}
.tbody{flex:1;overflow-y:auto;padding:22px 22px 10px}
.tstep{display:none;animation:sIn .35s ease}
.tstep.on{display:block}
@keyframes sIn{from{opacity:0;transform:translateX(14px)}to{opacity:1;transform:translateX(0)}}
.tsn{font-family:var(--mc);font-size:6px;color:var(--mid);letter-spacing:2px;margin-bottom:5px}
.tst{font-family:var(--mc);font-size:9px;color:var(--hi);letter-spacing:2px;margin-bottom:10px;display:flex;align-items:center;gap:10px}
.tsnum{background:var(--hi);color:#000;font-family:var(--mc);font-size:6px;padding:3px 7px;flex-shrink:0}
.tsd{font-size:11px;color:var(--lo);line-height:2;margin-bottom:16px;border-left:2px solid var(--b3);padding-left:12px}

.tcards{display:grid;grid-template-columns:repeat(auto-fill,minmax(172px,1fr));gap:7px;margin-bottom:14px}
.tc{background:var(--s2);border:1px solid var(--b2);padding:11px;transition:border-color .12s,transform .12s}
.tc:hover{border-color:var(--b4);transform:translateY(-1px)}
.tc-i{font-size:18px;margin-bottom:6px}
.tc-t{font-family:var(--mc);font-size:6px;color:var(--hi);letter-spacing:1px;margin-bottom:4px}
.tc-d{font-size:10px;color:var(--mid);line-height:1.8}
.tk{background:var(--s3);border:1px solid var(--b3);font-family:var(--mc);font-size:5px;color:var(--text);padding:2px 5px;display:inline-block;margin:1px}
.tnav{
  display:flex;align-items:center;padding:12px 22px 15px;
  border-top:1px solid var(--b1);gap:8px;flex-shrink:0;
}
.tdots{display:flex;gap:5px;flex:1;justify-content:center}
.tdot{width:7px;height:7px;background:var(--b3);cursor:pointer;border:1px solid var(--b3);transition:all .25s}
.tdot.on{background:var(--hi);border-color:var(--hi);transform:scale(1.15)}
.tbtn{
  background:var(--s2);border:1px solid var(--b2);color:var(--mid);
  font-family:var(--mc);font-size:6px;letter-spacing:1px;
  padding:8px 15px;cursor:pointer;transition:all .12s;white-space:nowrap;
}
.tbtn:hover{border-color:var(--b4);color:var(--hi)}
.tbtn.pr{background:var(--hi);color:#000;border-color:var(--hi)}
.tbtn.pr:hover{background:#e0e0e0}
.tbtn.sk{color:var(--mid)}
header{
  height:42px;display:flex;align-items:stretch;
  border-bottom:1px solid var(--b1);background:var(--s1);
  flex-shrink:0;position:relative;
}
header::after{content:'';position:absolute;bottom:0;left:0;right:0;height:1px;background:linear-gradient(90deg,rgba(255,255,255,.07),transparent 60%)}

.logo{
  font-family:var(--mc);font-size:7px;color:var(--hi);letter-spacing:3px;
  padding:0 16px;display:flex;align-items:center;
  border-right:1px solid var(--b1);white-space:nowrap;flex-shrink:0;
}
.logo em{color:var(--dim);font-style:normal}

.topbar{display:flex;align-items:stretch;flex:1}
.tmn{position:relative}
.tmnb{
  background:none;border:none;color:var(--mid);
  font-family:var(--mc);font-size:6px;letter-spacing:1px;
  padding:0 11px;height:42px;cursor:pointer;transition:all .1s;white-space:nowrap;
}
.tmnb:hover,.tmnb.op{background:var(--s3);color:var(--hi)}
.tdd{
  position:absolute;top:100%;left:0;background:var(--s2);
  border:1px solid var(--b3);min-width:188px;z-index:1000;display:none;
  box-shadow:0 10px 40px rgba(0,0,0,.95);
}
.tdd.op{display:block;animation:ddO .12s ease}
@keyframes ddO{from{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}
.tdi{
  display:flex;align-items:center;justify-content:space-between;
  padding:8px 12px;cursor:pointer;font-size:11px;color:var(--text);
  gap:14px;transition:background .08s;white-space:nowrap;
}
.tdi:hover{background:var(--s3);color:var(--hi)}
.tdi.sep{border-top:1px solid var(--b2)}
.tdi-k{font-size:7px;color:var(--dim);font-family:var(--mc)}
.tsep{width:1px;height:20px;background:var(--b2);margin:0 5px;align-self:center}

.hr{margin-left:auto;display:flex;align-items:center;gap:4px;padding-right:10px}
.hb{
  height:26px;padding:0 9px;background:var(--s2);border:1px solid var(--b1);
  color:var(--mid);font-family:var(--mc);font-size:6px;letter-spacing:1px;
  cursor:pointer;display:flex;align-items:center;gap:5px;transition:all .12s;flex-shrink:0;
}
.hb:hover{border-color:var(--b3);color:var(--hi)}
.toolstrip{
  height:40px;display:flex;align-items:center;
  border-bottom:1px solid var(--b1);background:var(--s2);
  padding:0 7px;gap:1px;flex-shrink:0;overflow-x:auto;
}
.toolstrip::-webkit-scrollbar{height:0}

.tb{
  width:32px;height:32px;background:none;border:1px solid transparent;
  color:var(--mid);cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:all .1s;position:relative;flex-shrink:0;
}
.tb:hover{background:var(--s3);border-color:var(--b2);color:var(--hi)}
.tb.on{background:var(--s4);border-color:var(--b3);color:var(--hi);box-shadow:inset 0 0 0 1px rgba(255,255,255,.06)}
.tb svg{width:16px;height:16px;pointer-events:none}
.tb .tp{
  position:absolute;bottom:calc(100%+5px);left:50%;transform:translateX(-50%);
  background:var(--s4);border:1px solid var(--b3);
  color:var(--text);font-family:var(--mc);font-size:5px;letter-spacing:1px;
  padding:3px 7px;white-space:nowrap;pointer-events:none;
  opacity:0;transition:opacity .12s;z-index:500;
}
.tb:hover .tp{opacity:1}
.tbs{width:1px;height:22px;background:var(--b2);margin:0 4px;flex-shrink:0}

.tcolor{
  width:26px;height:26px;border:1px solid var(--b3);cursor:pointer;
  flex-shrink:0;position:relative;overflow:hidden;transition:border-color .1s;
}
.tcolor:hover{border-color:var(--b4)}
.tcolor input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%}
.thex{font-family:var(--mc);font-size:6px;color:var(--mid);padding:0 7px;letter-spacing:1px;flex-shrink:0}

.tzoom{display:flex;align-items:center;gap:3px;margin-left:2px}
.tzb{width:20px;height:20px;background:var(--s3);border:1px solid var(--b2);color:var(--mid);font-size:13px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .1s;flex-shrink:0}
.tzb:hover{border-color:var(--b3);color:var(--hi)}
.tzv{font-family:var(--mc);font-size:6px;color:var(--mid);min-width:28px;text-align:center}

.tundo{
  height:24px;padding:0 9px;background:var(--s3);border:1px solid var(--b2);
  color:var(--mid);font-family:var(--mc);font-size:6px;cursor:pointer;
  display:flex;align-items:center;gap:4px;transition:all .1s;flex-shrink:0;
}
.tundo:hover:not(:disabled){border-color:var(--b3);color:var(--hi)}
.tundo:disabled{opacity:.22;cursor:not-allowed}
.ws{display:flex;flex:1;overflow:hidden;min-height:0}
.panel{
  width:212px;flex-shrink:0;border-right:1px solid var(--b1);
  background:var(--s1);display:flex;flex-direction:column;overflow:hidden;
}
.pscr{flex:1;overflow-y:auto;overflow-x:hidden}

.sec{padding:10px 11px 9px;border-bottom:1px solid var(--b1)}
.sechd{
  font-family:var(--mc);font-size:5px;letter-spacing:2px;
  color:var(--dim);text-transform:uppercase;margin-bottom:8px;
  display:flex;align-items:center;gap:6px;
}
.sechd::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,var(--b2),transparent)}
.bwg{display:flex;flex-wrap:wrap;gap:3px}
.bwc{width:19px;height:19px;cursor:pointer;border:1px solid transparent;transition:transform .1s,border-color .1s;flex-shrink:0}
.bwc:hover{transform:scale(1.2);border-color:var(--b3)}
.bwc.on{border-color:var(--hi)!important;transform:scale(1.1)}
.palg{display:flex;flex-wrap:wrap;gap:3px;min-height:19px}
.palc{width:20px;height:20px;cursor:pointer;border:1px solid transparent;transition:transform .1s,border-color .1s;flex-shrink:0}
.palc:hover{transform:scale(1.25);border-color:var(--b3)}
.palc.on{border-color:var(--hi)!important}
.pale{font-size:8px;color:var(--dim);letter-spacing:1px}
.pbtns{display:flex;gap:3px;margin-top:6px}
.smb{flex:1;background:var(--s2);border:1px solid var(--b2);color:var(--dim);font-family:var(--mc);font-size:5px;letter-spacing:1px;padding:5px 2px;cursor:pointer;transition:all .1s;text-align:center}
.smb:hover{border-color:var(--b3);color:var(--hi)}
.dz{border:1px dashed var(--b2);padding:11px 8px;text-align:center;cursor:pointer;background:var(--s2);transition:all .2s}
.dz:hover{border-color:var(--b4);background:var(--s3)}
.dz svg{width:22px;height:22px;margin:0 auto 4px;display:block;color:var(--dim)}
.dt{font-size:8px;color:var(--mid);letter-spacing:2px}
.ds{font-size:7px;color:var(--dim);letter-spacing:1px;margin-top:2px}
.eprev{width:100%;height:44px;object-fit:cover;display:block;margin-bottom:4px}
.cntr{display:flex;align-items:center;gap:4px;margin:6px 0}
.clbl{font-size:8px;color:var(--dim);flex:1;letter-spacing:1px}
.icb{width:22px;height:22px;background:var(--s2);border:1px solid var(--b2);color:var(--mid);font-size:13px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .1s}
.icb:hover{border-color:var(--b3);color:var(--hi)}
.cval{font-family:var(--mc);font-size:7px;color:var(--hi);width:22px;text-align:center}
.actb{width:100%;background:var(--hi);border:none;color:#000;font-family:var(--mc);font-size:6px;letter-spacing:2px;padding:9px;cursor:pointer;transition:all .15s}
.actb:hover{background:#ddd}
.actb.ok{background:#8fef8f}
.actb:disabled{background:var(--b2);color:var(--dim);cursor:not-allowed}
.slr{display:flex;align-items:center;gap:6px;margin-bottom:5px}
.sll{font-size:8px;color:var(--dim);letter-spacing:1px;width:46px}
input[type=range]{flex:1;height:2px;accent-color:var(--hi);background:var(--s3);cursor:pointer}
.slv{font-size:7px;color:var(--mid);width:26px;text-align:right;font-family:var(--mc)}
.posg{display:grid;grid-template-columns:1fr 1fr;gap:3px;margin-top:3px}
.posb{background:var(--s2);border:1px solid var(--b2);color:var(--dim);font-family:var(--mc);font-size:5px;letter-spacing:1px;padding:5px 2px;cursor:pointer;transition:all .1s;text-align:center}
.posb:hover{border-color:var(--b3);color:var(--hi)}
.posb.on{border-color:var(--hi);color:var(--hi);background:var(--s3)}
.szr{display:flex;gap:5px;align-items:flex-end}
.szf{flex:1}
.szf label{display:block;font-size:6px;color:var(--dim);letter-spacing:2px;margin-bottom:3px}
.szi{width:100%;background:var(--s2);border:1px solid var(--b2);color:var(--hi);font-family:var(--mc);font-size:12px;padding:6px 5px;text-align:center;outline:none;transition:border-color .1s}
.szi:focus{border-color:var(--b3)}
.szx{color:var(--dim);font-size:13px;padding-bottom:7px}
.fullb{width:100%;background:var(--s2);border:1px solid var(--b2);color:var(--mid);font-family:var(--mc);font-size:5px;letter-spacing:2px;padding:7px;cursor:pointer;margin-top:6px;transition:all .1s}
.fullb:hover{border-color:var(--b3);color:var(--hi)}
.qsz{display:flex;gap:3px;margin-top:5px;flex-wrap:wrap}
.pbot{border-top:1px solid var(--b1);padding:9px 11px;display:flex;flex-direction:column;gap:4px}
.expb{background:var(--hi);border:none;color:#000;font-family:var(--mc);font-size:7px;letter-spacing:3px;padding:11px;cursor:pointer;transition:all .15s;width:100%}
.expb:hover{background:#d8d8d8}
.dngb{background:transparent;border:1px solid var(--b2);color:var(--dim);font-family:var(--mc);font-size:5px;letter-spacing:2px;padding:6px;cursor:pointer;width:100%;transition:all .1s}
.dngb:hover{border-color:#f55;color:#f55}
.cva{flex:1;display:flex;align-items:center;justify-content:center;overflow:auto;background:var(--bg);position:relative}
.cva::before{content:'';position:absolute;inset:0;background-image:radial-gradient(circle,var(--b1) 1px,transparent 1px);background-size:22px 22px;pointer-events:none;opacity:.65}
#px{cursor:crosshair;display:block;image-rendering:pixelated;position:relative;z-index:1;box-shadow:0 0 0 1px var(--b2),0 16px 80px rgba(0,0,0,.97)}
#refimg{position:absolute;z-index:10;pointer-events:none;border:1px solid rgba(255,255,255,.07);display:none}
.stb{height:24px;border-top:1px solid var(--b1);background:var(--s1);display:flex;align-items:center;padding:0 12px;gap:16px;flex-shrink:0}
.si{font-size:7px;color:var(--dim);letter-spacing:1px}
.si span{color:var(--lo)}
.si strong{color:var(--hi);font-family:var(--mc);font-size:6px}
@keyframes glitch{
  0%{transform:translate(0);filter:none}
  20%{transform:translate(-3px,1px);filter:hue-rotate(90deg) brightness(2)}
  40%{transform:translate(3px,-2px);filter:hue-rotate(-90deg)}
  60%{transform:translate(-2px,2px);filter:brightness(1.8)}
  80%{transform:translate(2px,-1px);filter:hue-rotate(180deg)}
  100%{transform:translate(0);filter:none}
}
.ititle.g{animation:glitch .15s steps(3)}
</style>
</head>
<body>
<div id="intro">
  <div class="ig"></div>
  <div class="ic"><span></span><span></span><span></span><span></span></div>
  <div class="ilines"><div class="iline-h t"></div><div class="iline-h b"></div></div>
  <div class="imain">
    <div class="ipre">PIXEL TEXTURE EDITOR</div>
    <div class="ititle" id="ititle"><span class="icur" id="icur"></span></div>
    <div class="isub">PROFESJONALNY EDYTOR TEKSTUR</div>
    <div class="ibar"></div>
    <div class="ibtm">
      <span class="ibtm-item">MINECRAFT</span>
      <span class="ibtm-item">¬∑</span>
      <span class="ibtm-item">PIXEL ART</span>
      <span class="ibtm-item">¬∑</span>
      <span class="ibtm-item">v3.0</span>
    </div>
  </div>
  <div class="iskip" onclick="skipIntro()">POMI≈É [ESC] ‚Üí</div>
</div>
<div id="tut">
 <div class="tw">
  <div class="thd">
   <div class="thd-t">PORADNIK ‚Äî X_FAZI TEXTURE MAKER</div>
   <div class="thd-x" onclick="closeTut()">‚úï</div>
  </div>
  <div class="tprog"><div class="tpfill" id="tpf" style="width:20%"></div></div>
  <div class="tbody">
   <div class="tstep on" id="ts0">
    <div class="tsn">KROK 01 / 05</div>
    <div class="tst"><div class="tsnum">01</div>WITAJ W X_FAZI TEXTURE MAKER</div>
    <div class="tsd">Profesjonalny edytor tekstur pikselowych dla Minecrafta ‚Äî wszystko w jednym miejscu. Ten kr√≥tki poradnik poka≈ºe Ci jak u≈ºywaƒá wszystkich funkcji.</div>
    <div class="tcards">
     <div class="tc"><div class="tc-i">‚úèÔ∏è</div><div class="tc-t">RYSOWANIE</div><div class="tc-d">O≈Ç√≥wek, gumka, wiadro, linia, prostokƒÖt, elipsa ‚Äî pe≈Çny zestaw narzƒôdzi.</div></div>
     <div class="tc"><div class="tc-i">üé®</div><div class="tc-t">KOLORY</div><div class="tc-d">Paleta B/W, zbieracz z ekranu, ekstrakcja ze zdjƒôcia, historia kolor√≥w.</div></div>
     <div class="tc"><div class="tc-i">‚Ü©Ô∏è</div><div class="tc-t">HISTORIA</div><div class="tc-d">Do 50 krok√≥w cofania i przywracania. Ctrl+Z / Ctrl+Y.</div></div>
     <div class="tc"><div class="tc-i">üì§</div><div class="tc-t">EKSPORT</div><div class="tc-d">PNG bez t≈Ça w dok≈Çadnym rozmiarze pikseli ‚Äî gotowe do Minecrafta!</div></div>
    </div>
   </div>
   <div class="tstep" id="ts1">
    <div class="tsn">KROK 02 / 05</div>
    <div class="tst"><div class="tsnum">02</div>NARZƒòDZIA RYSOWANIA</div>
    <div class="tsd">Wszystkie narzƒôdzia w pasku pod menu. Ka≈ºde ma te≈º skr√≥t klawiszowy.</div>
    <div class="tcards">
     <div class="tc"><div class="tc-i">‚úèÔ∏è</div><div class="tc-t">O≈Å√ìWEK <span class="tk">P</span></div><div class="tc-d">Rysuje piksele. PrzeciƒÖgnij myszƒÖ ≈ºeby malowaƒá p≈Çynnie.</div></div>
     <div class="tc"><div class="tc-i">üßπ</div><div class="tc-t">GUMKA <span class="tk">E</span></div><div class="tc-d">Usuwa piksele ‚Äî robi je przezroczystymi (szachownica = prze≈∫roczysto≈õƒá).</div></div>
     <div class="tc"><div class="tc-i">ü™£</div><div class="tc-t">WYPE≈ÅNIENIE <span class="tk">F</span></div><div class="tc-d">Wype≈Çnia ca≈Çy obszar jednym kolorem jak wiadro farby.</div></div>
     <div class="tc"><div class="tc-i">üíâ</div><div class="tc-t">PIPETA <span class="tk">I</span></div><div class="tc-d">Pobiera kolor z piksela i zapisuje go do historii palety.</div></div>
     <div class="tc"><div class="tc-i">üñ•Ô∏è</div><div class="tc-t">ZBIERACZ EKRANU</div><div class="tc-d">Kliknij DOWOLNE miejsce na ekranie ≈ºeby pobraƒá kolor! (Chrome/Edge)</div></div>
     <div class="tc"><div class="tc-i">üìê</div><div class="tc-t">LINIA <span class="tk">L</span></div><div class="tc-d">Kliknij i przeciƒÖgnij ≈ºeby narysowaƒá prostƒÖ liniƒô.</div></div>
     <div class="tc"><div class="tc-i">‚¨ú</div><div class="tc-t">PROSTOKƒÑT <span class="tk">R</span></div><div class="tc-d">ProstokƒÖt ‚Äî obramowanie lub wype≈Çniony. Tryb: menu Edycja.</div></div>
     <div class="tc"><div class="tc-i">‚≠ï</div><div class="tc-t">ELIPSA / KO≈ÅO <span class="tk">O</span></div><div class="tc-d">Rysuje elipsƒô lub ko≈Ço w stylu pikselowym.</div></div>
    </div>
   </div>
   <div class="tstep" id="ts2">
    <div class="tsn">KROK 03 / 05</div>
    <div class="tst"><div class="tsnum">03</div>KOLORY I PALETA</div>
    <div class="tsd">Aktywny kolor widaƒá w pasku ‚Äî kliknij prostokƒÖt koloru ≈ºeby go zmieniƒá. Ka≈ºdy u≈ºyty kolor automatycznie trafia do historii.</div>
    <div class="tcards">
     <div class="tc"><div class="tc-i">‚¨ú‚¨õ</div><div class="tc-t">ODCIENIE B/W</div><div class="tc-d">9 odcieni od bia≈Çego do czarnego w lewym panelu. Kliknij ≈ºeby wybraƒá.</div></div>
     <div class="tc"><div class="tc-i">üñ•Ô∏è</div><div class="tc-t">ZBIERACZ Z EKRANU</div><div class="tc-d">Narzƒôdzie "monitor" w pasku. Kliknij cokolwiek na ekranie ‚Äî kolor zostanie pobrany.</div></div>
     <div class="tc"><div class="tc-i">üñºÔ∏è</div><div class="tc-t">EKSTRAKCJA ZE ZDJƒòCIA</div><div class="tc-d">Wgraj zdjƒôcie ‚Üí aplikacja wyciƒÖgnie dominujƒÖce kolory ‚Üí dodaje je do palety.</div></div>
     <div class="tc"><div class="tc-i">üíæ</div><div class="tc-t">HISTORIA KOLOR√ìW</div><div class="tc-d">Do 64 kolor√≥w. Kliknij na palecie ≈ºeby szybko wybraƒá. Sortuj jednym klikniƒôciem.</div></div>
    </div>
   </div>
   <div class="tstep" id="ts3">
    <div class="tsn">KROK 04 / 05</div>
    <div class="tst"><div class="tsnum">04</div>WZORZEC REFERENCYJNY</div>
    <div class="tsd">Wgraj dowolne zdjƒôcie jako wzorzec ‚Äî pojawi siƒô w rogu ekranu jako pomoc wizualna. Nie wp≈Çywa na eksport.</div>
    <div class="tcards">
     <div class="tc"><div class="tc-i">üìå</div><div class="tc-t">POZYCJA</div><div class="tc-d">4 rogi: lewy g√≥rny, prawy g√≥rny, lewy dolny, prawy dolny.</div></div>
     <div class="tc"><div class="tc-i">üîÜ</div><div class="tc-t">KRYCIE</div><div class="tc-d">Zmniejsz przezroczysto≈õƒá wzorca ≈ºeby nie przeszkadza≈Ç przy rysowaniu.</div></div>
     <div class="tc"><div class="tc-i">üìè</div><div class="tc-t">ROZMIAR</div><div class="tc-d">Suwak rozmiaru ‚Äî dopasuj wielko≈õƒá wzorca do swoich potrzeb.</div></div>
    </div>
   </div>
   <div class="tstep" id="ts4">
    <div class="tsn">KROK 05 / 05</div>
    <div class="tst"><div class="tsnum">05</div>SKR√ìTY I EKSPORT</div>
    <div class="tsd">Zapamiƒôtaj skr√≥ty ‚Äî znacznie przyspieszƒÖ pracƒô. Eksport PNG pobiera plik gotowy do Minecrafta.</div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:7px;margin-bottom:12px">
     <div style="background:var(--s2);border:1px solid var(--b2);padding:12px">
      <div style="font-family:var(--mc);font-size:6px;color:var(--hi);margin-bottom:8px;letter-spacing:1px">NARZƒòDZIA</div>
      <div style="font-size:10px;color:var(--mid);line-height:2.4"><span class="tk">P</span> O≈Ç√≥wek &nbsp;<span class="tk">E</span> Gumka<br><span class="tk">F</span> Wype≈Çnienie &nbsp;<span class="tk">I</span> Pipeta<br><span class="tk">L</span> Linia &nbsp;<span class="tk">R</span> ProstokƒÖt<br><span class="tk">O</span> Elipsa</div>
     </div>
     <div style="background:var(--s2);border:1px solid var(--b2);padding:12px">
      <div style="font-family:var(--mc);font-size:6px;color:var(--hi);margin-bottom:8px;letter-spacing:1px">AKCJE</div>
      <div style="font-size:10px;color:var(--mid);line-height:2.4"><span class="tk">Ctrl+Z</span> Cofnij<br><span class="tk">Ctrl+Y</span> Pon√≥w<br><span class="tk">Scroll</span> Zoom<br><span class="tk">0</span> Dopasuj zoom<br><span class="tk">Ctrl+S</span> Eksportuj</div>
     </div>
    </div>
    <div style="background:var(--s2);border:1px solid var(--b2);padding:12px;text-align:center">
     <div style="font-family:var(--mc);font-size:6px;color:var(--hi);margin-bottom:5px;letter-spacing:2px">‚¨á EKSPORT PNG</div>
     <div style="font-size:10px;color:var(--mid);line-height:1.9">Kliknij <b style="color:#fff">EKSPORTUJ PNG</b> lub u≈ºyj <b style="color:#fff">Plik ‚Üí Eksportuj</b>.<br>Plik pobierze siƒô w dok≈Çadnym rozmiarze pikseli ‚Äî bez t≈Ça!</div>
    </div>
   </div>
  </div>
  <div class="tnav">
   <button class="tbtn sk" onclick="closeTut()">POMI≈É</button>
   <div class="tdots" id="tdots">
    <div class="tdot on" onclick="goS(0)"></div>
    <div class="tdot" onclick="goS(1)"></div>
    <div class="tdot" onclick="goS(2)"></div>
    <div class="tdot" onclick="goS(3)"></div>
    <div class="tdot" onclick="goS(4)"></div>
   </div>
   <button class="tbtn" id="tprev" onclick="prevS()" style="display:none">‚Üê WSTECZ</button>
   <button class="tbtn pr" id="tnext" onclick="nextS()">DALEJ ‚Üí</button>
  </div>
 </div>
</div>
<header>
 <div class="logo">X_FAZI <em>/</em> TEXTURE MAKER</div>
 <div class="topbar">
  <div class="tmn" id="m-plik"><button class="tmnb" onclick="tog('plik')">PLIK</button>
   <div class="tdd" id="dd-plik">
    <div class="tdi" onclick="newCanvas();cm()">Nowe p≈Ç√≥tno<span class="tdi-k">Ctrl+N</span></div>
    <div class="tdi sep" onclick="exportPNG();cm()">Eksportuj PNG<span class="tdi-k">Ctrl+S</span></div>
    <div class="tdi" onclick="exportBig();cm()">Eksportuj √ó4 powiƒôkszony</div>
   </div>
  </div>
  <div class="tmn" id="m-edycja"><button class="tmnb" onclick="tog('edycja')">EDYCJA</button>
   <div class="tdd" id="dd-edycja">
    <div class="tdi" onclick="undo();cm()">Cofnij<span class="tdi-k">Ctrl+Z</span></div>
    <div class="tdi" onclick="redo();cm()">Pon√≥w<span class="tdi-k">Ctrl+Y</span></div>
    <div class="tdi sep" onclick="clearCanvas();cm()">Wyczy≈õƒá p≈Ç√≥tno</div>
    <div class="tdi" onclick="flipH();cm()">Odbij poziomo</div>
    <div class="tdi" onclick="flipV();cm()">Odbij pionowo</div>
    <div class="tdi" onclick="rot90();cm()">Obr√≥ƒá 90¬∞</div>
    <div class="tdi" onclick="invertColors();cm()">Odwr√≥ƒá kolory</div>
    <div class="tdi sep" onclick="toggleFill();cm()" id="fillitem">Tryb kszta≈Çtu: OBRAMOWANIE</div>
   </div>
  </div>
  <div class="tmn" id="m-widok"><button class="tmnb" onclick="tog('widok')">WIDOK</button>
   <div class="tdd" id="dd-widok">
    <div class="tdi" onclick="chZoom(1);cm()">Przybli≈º<span class="tdi-k">+</span></div>
    <div class="tdi" onclick="chZoom(-1);cm()">Oddal<span class="tdi-k">-</span></div>
    <div class="tdi sep" onclick="fitZ();cm()">Dopasuj do ekranu<span class="tdi-k">0</span></div>
    <div class="tdi" onclick="setZ1();cm()">100% (1√ó)<span class="tdi-k">1</span></div>
   </div>
  </div>
  <div class="tmn" id="m-pomoc"><button class="tmnb" onclick="tog('pomoc')">POMOC</button>
   <div class="tdd" id="dd-pomoc">
    <div class="tdi" onclick="openTut();cm()">Poradnik<span class="tdi-k">?</span></div>
   </div>
  </div>
 </div>
 <div class="hr"><button class="hb" onclick="openTut()">? POMOC</button></div>
</header>
<div class="toolstrip">
 <button class="tb on" id="tb-pencil" onclick="setTool('pencil')"><span class="tp">O≈Å√ìWEK [P]</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg></button>
 <button class="tb" id="tb-eraser" onclick="setTool('eraser')"><span class="tp">GUMKA [E]</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M20 20H7L3 16l11-11 7 7-2 4z"/><path d="M6 18l4-4"/></svg></button>
 <button class="tb" id="tb-fill" onclick="setTool('fill')"><span class="tp">WYPE≈ÅNIENIE [F]</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M19 11l-8-8-8.5 8.5a5.5 5.5 0 007.78 7.78L19 11z"/><path d="M20.5 18.5c.83.83.83 2.17 0 3s-2.17.83-3 0"/></svg></button>
 <button class="tb" id="tb-eyedropper" onclick="setTool('eyedropper')"><span class="tp">PIPETA [I]</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M20 14l-9-9-11 11 2 2 2-1 8 8 4-4-1-2 5-5z"/><circle cx="4.5" cy="19.5" r="2.5"/></svg></button>
 <button class="tb" id="tb-screen" onclick="screenPick()"><span class="tp">ZBIERACZ Z EKRANU</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="2" y="3" width="20" height="14" rx="1"/><path d="M8 21h8M12 17v4"/><circle cx="12" cy="10" r="3"/></svg></button>
 <div class="tbs"></div>
 <button class="tb" id="tb-line" onclick="setTool('line')"><span class="tp">LINIA [L]</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M5 19L19 5"/></svg></button>
 <button class="tb" id="tb-rect" onclick="setTool('rect')"><span class="tp">PROSTOKƒÑT [R]</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="5" width="18" height="14"/></svg></button>
 <button class="tb" id="tb-ellipse" onclick="setTool('ellipse')"><span class="tp">ELIPSA/KO≈ÅO [O]</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><ellipse cx="12" cy="12" rx="10" ry="7"/></svg></button>
 <div class="tbs"></div>
 <div class="tcolor" id="tcol"><input type="color" id="tcp" value="#ffffff" oninput="setColor(this.value)"></div>
 <div class="thex" id="thex">#FFFFFF</div>
 <div class="tbs"></div>
 <button class="tundo" id="tu-undo" onclick="undo()" disabled><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="11" height="11"><path d="M3 10h10a8 8 0 018 8v2M3 10l6 6M3 10l6-6"/></svg>COFNIJ</button>
 <button class="tundo" id="tu-redo" onclick="redo()" disabled>PON√ìW<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="11" height="11"><path d="M21 10H11a8 8 0 00-8 8v2M21 10l-6 6M21 10l-6-6"/></svg></button>
 <div class="tbs"></div>
 <div class="tzoom"><button class="tzb" onclick="chZoom(-1)">‚àí</button><div class="tzv" id="tzv">24√ó</div><button class="tzb" onclick="chZoom(1)">+</button></div>
</div>
<div class="ws">
 <div class="panel">
  <div class="pscr">
   <div class="sec"><div class="sechd">Odcienie B/W</div><div class="bwg" id="bwg"></div></div>
   <div class="sec">
    <div class="sechd">U≈ºywane kolory</div>
    <div class="palg" id="palg"><div class="pale">‚Äî wybierz kolor ‚Äî</div></div>
    <div class="pbtns">
     <button class="smb" onclick="clearPal()">Wyczy≈õƒá</button>
     <button class="smb" onclick="sortPal()">Sortuj</button>
    </div>
   </div>
   <div class="sec">
    <div class="sechd">Historia</div>
    <div style="display:flex;gap:3px">
     <button class="smb" id="sb-undo" onclick="undo()" style="flex:1;padding:7px">‚Ü© COFNIJ</button>
     <button class="smb" id="sb-redo" onclick="redo()" style="flex:1;padding:7px">PON√ìW ‚Ü™</button>
    </div>
    <div style="font-size:7px;color:var(--dim);letter-spacing:1px;margin-top:5px;text-align:center" id="hinfo">brak historii</div>
   </div>
   <div class="sec">
    <div class="sechd">Ekstrakcja kolor√≥w</div>
    <div class="dz" id="extdrop" onclick="document.getElementById('extfile').click()" ondrop="onExtDrop(event)" ondragover="event.preventDefault()">
     <div id="extinn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg><div class="dt">WGRAJ ZDJƒòCIE</div><div class="ds">PNG, JPG ‚Äî drag & drop</div></div>
    </div>
    <input type="file" id="extfile" accept="image/*" style="display:none" onchange="loadExtImg(this.files[0])">
    <div id="extctrl" style="display:none;margin-top:7px">
     <div class="cntr"><div class="clbl">Ilo≈õƒá kolor√≥w:</div><button class="icb" onclick="chEC(-4)">‚àí</button><div class="cval" id="ecnt">16</div><button class="icb" onclick="chEC(4)">+</button></div>
     <button class="actb" id="extbtn" onclick="extractColors()">WYCIƒÑGNIJ KOLORY</button>
    </div>
   </div>
   <div class="sec">
    <div class="sechd">Wzorzec / Referencja</div>
    <div class="dz" id="refdrop" onclick="document.getElementById('reffile').click()" ondrop="onRefDrop(event)" ondragover="event.preventDefault()">
     <div id="refinn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg><div class="dt">WGRAJ WZORZEC</div><div class="ds">pojawi siƒô w rogu ekranu</div></div>
    </div>
    <input type="file" id="reffile" accept="image/*" style="display:none" onchange="loadRefImg(this.files[0])">
    <div id="refctrl" style="display:none;margin-top:7px">
     <div class="slr"><div class="sll">ROZMIAR</div><input type="range" id="rfsz" min="60" max="360" value="150" oninput="updRef()"><div class="slv" id="rfszv">150</div></div>
     <div class="slr"><div class="sll">KRYCIE</div><input type="range" id="rfop" min="10" max="100" value="60" oninput="updRef()"><div class="slv" id="rfopv">60%</div></div>
     <div style="font-size:6px;color:var(--dim);letter-spacing:1px;margin:5px 0 3px">POZYCJA:</div>
     <div class="posg">
      <div class="posb on" id="pos-tl" onclick="setRP('tl')">‚Üñ L.G√ìR</div>
      <div class="posb" id="pos-tr" onclick="setRP('tr')">‚Üó P.G√ìR</div>
      <div class="posb" id="pos-bl" onclick="setRP('bl')">‚Üô L.D√ì≈Å</div>
      <div class="posb" id="pos-br" onclick="setRP('br')">‚Üò P.D√ì≈Å</div>
     </div>
     <button class="dngb" style="margin-top:5px" onclick="removeRef()">Usu≈Ñ wzorzec</button>
    </div>
   </div>
   <div class="sec">
    <div class="sechd">Rozmiar p≈Ç√≥tna</div>
    <div class="szr">
     <div class="szf"><label>SZEROKO≈öƒÜ</label><input class="szi" type="number" id="inpw" value="16" min="1" max="256"></div>
     <div class="szx">√ó</div>
     <div class="szf"><label>WYSOKO≈öƒÜ</label><input class="szi" type="number" id="inph" value="16" min="1" max="256"></div>
    </div>
    <button class="fullb" onclick="applySize()">Zastosuj rozmiar</button>
    <div class="qsz">
     <button class="smb" onclick="setSize(16,16)">16√ó16</button>
     <button class="smb" onclick="setSize(32,32)">32√ó32</button>
     <button class="smb" onclick="setSize(64,64)">64√ó64</button>
     <button class="smb" onclick="setSize(128,128)">128</button>
    </div>
   </div>
  </div>
  <div class="pbot">
   <button class="expb" onclick="exportPNG()">‚¨á EKSPORTUJ PNG</button>
   <button class="dngb" onclick="clearCanvas()">‚úï WYCZY≈öƒÜ P≈Å√ìTNO</button>
  </div>
 </div>
 <div class="cva" id="cva"><canvas id="px"></canvas><img id="refimg"></div>
</div>
<div class="stb">
 <div class="si">NARZƒòDZIE: <strong id="st-tool">O≈Å√ìWEK</strong></div>
 <div class="si">POZYCJA: <span id="st-pos">‚Äî</span></div>
 <div class="si">P≈Å√ìTNO: <span id="st-size">16√ó16</span></div>
 <div class="si">KOLORY: <span id="st-cols">0</span></div>
 <div class="si">ZOOM: <span id="st-zoom">24√ó</span></div>
 <div class="si">HISTORIA: <span id="st-hist">‚Äî</span></div>
</div>
<script>
const TITLE='X_FAZI';
const ititle=document.getElementById('ititle');
const icur=document.getElementById('icur');
let ci=0;
const _grid=document.querySelector('.ig');
const _gInt=setInterval(()=>{
  _grid.style.transform=`translate(${(Math.random()-.5)*4}px,0)`;
  _grid.style.opacity=0.3+Math.random()*0.7;
  setTimeout(()=>{_grid.style.transform='';_grid.style.opacity='';},55);
},350);
const _pre=document.querySelector('.ipre');
setInterval(()=>{_pre.style.opacity=0.3+Math.random()*0.5;},200);
function typeNext(){
  if(ci>=TITLE.length){
    clearInterval(_gInt);
    let gc=0;
    const _gf=setInterval(()=>{
      ititle.classList.toggle('g');
      if(++gc>6){clearInterval(_gf);ititle.classList.remove('g');}
    },80);
    setTimeout(hideIntro,1400);
    return;
  }
  const ch=TITLE[ci];
  const sp=document.createElement('span');
  sp.className='ich'+(ch==='_'?' sep':'');
  sp.textContent=ch;
  sp.style.animationDelay='0s';
  ititle.insertBefore(sp,icur);
  ci++;
  const delay=ci===1?130:45+Math.random()*90+(ch==='_'?110:0);
  setTimeout(typeNext,delay);
}
setTimeout(typeNext,900);

function hideIntro(){
  const el=document.getElementById('intro');
  el.classList.add('out');
  setTimeout(()=>{el.style.display='none';openTut();},800);
}

function skipIntro(){
  const el=document.getElementById('intro');
  el.style.opacity='0';el.style.transition='opacity .25s';
  setTimeout(()=>{el.style.display='none';openTut();},260);
}
let TS=0;
const NSTEPS=5;
function goS(n){
  document.querySelectorAll('.tstep').forEach((s,i)=>s.classList.toggle('on',i===n));
  document.querySelectorAll('.tdot').forEach((d,i)=>d.classList.toggle('on',i===n));
  document.getElementById('tpf').style.width=((n+1)/NSTEPS*100)+'%';
  document.getElementById('tprev').style.display=n>0?'':'none';
  document.getElementById('tnext').textContent=n===NSTEPS-1?'ZACZNIJ ‚Üí':'DALEJ ‚Üí';
  TS=n;
}
function nextS(){TS<NSTEPS-1?goS(TS+1):closeTut();}
function prevS(){TS>0&&goS(TS-1);}
function closeTut(){document.getElementById('tut').classList.remove('on');}
function openTut(){document.getElementById('tut').classList.add('on');goS(0);}
function tog(name){
  const dd=document.getElementById('dd-'+name);
  const btn=document.querySelector('#m-'+name+' .tmnb');
  const was=dd.classList.contains('op');
  cm();
  if(!was){dd.classList.add('op');btn.classList.add('op');}
}
function cm(){
  document.querySelectorAll('.tdd').forEach(d=>d.classList.remove('op'));
  document.querySelectorAll('.tmnb').forEach(b=>b.classList.remove('op'));
}
document.addEventListener('click',e=>{if(!e.target.closest('.tmn'))cm();});
let W=16,H=16,ZOOM=24;
let tool='pencil',color='#ffffff';
let pixels=[],painting=false,lastCell=null;
let usedColors=[];
let extCount=16,refPos='tl',extImgEl=null;
let shapeStart=null,shapePreview=[],shapeFill=false;
let history=[],histIdx=-1;
const MAX_HIST=50;
const ZOOMS=[1,2,3,4,6,8,10,12,16,20,24,32,40,48,64];
let zIdx=10;
const BW=['#ffffff','#e8e8e8','#d0d0d0','#b0b0b0','#888888','#606060','#404040','#222222','#000000'];
const TNAMES={pencil:'O≈Å√ìWEK',eraser:'GUMKA',fill:'WYPE≈ÅNIENIE',eyedropper:'PIPETA',line:'LINIA',rect:'PROSTOKƒÑT',ellipse:'ELIPSA'};
function init(){
  pixels=mk(W,H);buildBW();buildFullPalette();setColor('#ffffff');render();updStatus();pushH();
}

const FULL_PALETTE=[
  '#ffffff','#f0f0f0','#d8d8d8','#c0c0c0','#a8a8a8','#909090','#787878','#606060','#484848','#303030','#181818','#000000',
  '#ff0000','#cc0000','#990000','#ff4444','#ff8888','#ffcccc',
  '#ff8800','#cc6600','#ff9933','#ffbb66','#ffd599','#ffeecc',
  '#ffff00','#cccc00','#999900','#ffff44','#ffff99','#ffffcc',
  '#00cc00','#009900','#006600','#33ff33','#88ff88','#ccffcc',
  '#0088ff','#0066cc','#004499','#44aaff','#99ccff','#cce6ff',
  '#8800ff','#6600cc','#440099','#aa44ff','#cc99ff','#eeccff',
  '#ff00cc','#cc0099','#990066','#ff44dd','#ff99ee','#ffccf7',
  '#00ffff','#00cccc','#009999','#66ffff','#99ffff','#ccffff',
  '#ff6600','#cc3300','#993300','#ff9944','#ffbb88','#ffddcc',
  '#884400','#663300','#441100','#aa6622','#cc9944','#eebb77',
];

function buildFullPalette(){
  const g=document.getElementById('fullpal');g.innerHTML='';
  FULL_PALETTE.forEach(h=>{
    const d=document.createElement('div');
    d.style.cssText=`width:18px;height:18px;background:${h};cursor:pointer;border:1px solid transparent;flex-shrink:0;transition:transform .1s,border-color .1s`;
    d.title=h;
    d.onmouseenter=()=>{d.style.transform='scale(1.25)';d.style.borderColor='#fff';};
    d.onmouseleave=()=>{d.style.transform='';d.style.borderColor='transparent';};
    d.onclick=()=>{setColor(h);addUsed(h);};
    g.appendChild(d);
  });
}
function mk(w,h){return Array.from({length:h},()=>Array(w).fill(''));}

function buildBW(){
  const g=document.getElementById('bwg');g.innerHTML='';
  BW.forEach(h=>{
    const d=document.createElement('div');
    d.className='bwc'+(h===color?' on':'');
    d.style.background=h;d.title=h;d.onclick=()=>setColor(h);
    g.appendChild(d);
  });
}
function render(){
  const cv=document.getElementById('px');
  cv.width=W*ZOOM;cv.height=H*ZOOM;
  const ctx=cv.getContext('2d');ctx.imageSmoothingEnabled=false;
  for(let y=0;y<H;y++) for(let x=0;x<W;x++){
    const c=pixels[y][x];
    ctx.fillStyle=c||((x+y)%2===0?'#1c1c1c':'#141414');
    ctx.fillRect(x*ZOOM,y*ZOOM,ZOOM,ZOOM);
  }
  shapePreview.forEach(([x,y])=>{
    if(x>=0&&x<W&&y>=0&&y<H){ctx.fillStyle=color;ctx.fillRect(x*ZOOM,y*ZOOM,ZOOM,ZOOM);}
  });
  if(ZOOM>=5){
    ctx.strokeStyle='rgba(255,255,255,0.035)';ctx.lineWidth=1;
    for(let x=0;x<=W;x++){ctx.beginPath();ctx.moveTo(x*ZOOM,0);ctx.lineTo(x*ZOOM,H*ZOOM);ctx.stroke();}
    for(let y=0;y<=H;y++){ctx.beginPath();ctx.moveTo(0,y*ZOOM);ctx.lineTo(W*ZOOM,y*ZOOM);ctx.stroke();}
  }
}
function pushH(){
  if(histIdx<history.length-1)history.splice(histIdx+1);
  history.push(pixels.map(r=>[...r]));
  if(history.length>MAX_HIST)history.shift();
  histIdx=history.length-1;updH();
}
function undo(){if(histIdx<=0)return;histIdx--;pixels=history[histIdx].map(r=>[...r]);render();updH();}
function redo(){if(histIdx>=history.length-1)return;histIdx++;pixels=history[histIdx].map(r=>[...r]);render();updH();}
function updH(){
  const ud=histIdx<=0,rd=histIdx>=history.length-1;
  ['tu-undo','sb-undo'].forEach(id=>{const b=document.getElementById(id);if(b)b.disabled=ud;});
  ['tu-redo','sb-redo'].forEach(id=>{const b=document.getElementById(id);if(b)b.disabled=rd;});
  document.getElementById('hinfo').textContent=`krok ${histIdx+1} z ${history.length}`;
  document.getElementById('st-hist').textContent=`${histIdx+1}/${history.length}`;
}
function setTool(t){
  tool=t;shapeStart=null;shapePreview=[];
  document.querySelectorAll('.tb').forEach(b=>b.classList.remove('on'));
  const btn=document.getElementById('tb-'+t);if(btn)btn.classList.add('on');
  document.getElementById('st-tool').textContent=TNAMES[t]||t.toUpperCase();
  document.getElementById('px').style.cursor='crosshair';
}
function cellAt(e){
  const r=document.getElementById('px').getBoundingClientRect();
  const x=Math.floor((e.clientX-r.left)/ZOOM);
  const y=Math.floor((e.clientY-r.top)/ZOOM);
  return(x<0||x>=W||y<0||y>=H)?null:{x,y};
}
function applyAt(x,y){
  if(tool==='pencil'){pixels[y][x]=color;addUsed(color);}
  else if(tool==='eraser'){pixels[y][x]='';}
  else if(tool==='eyedropper'){if(pixels[y][x])setColor(pixels[y][x]);setTool('pencil');return;}
  else if(tool==='fill'){flood(x,y,pixels[y][x],color);addUsed(color);}
  render();
}
function bres(x0,y0,x1,y1){
  const pts=[];let dx=Math.abs(x1-x0),dy=Math.abs(y1-y0);
  let sx=x0<x1?1:-1,sy=y0<y1?1:-1,err=dx-dy;
  while(true){pts.push([x0,y0]);if(x0===x1&&y0===y1)break;const e2=2*err;if(e2>-dy){err-=dy;x0+=sx;}if(e2<dx){err+=dx;y0+=sy;}}
  return pts;
}
function rectPts(x0,y0,x1,y1){
  const pts=[],mnx=Math.min(x0,x1),mxx=Math.max(x0,x1),mny=Math.min(y0,y1),mxy=Math.max(y0,y1);
  if(shapeFill){for(let y=mny;y<=mxy;y++)for(let x=mnx;x<=mxx;x++)pts.push([x,y]);}
  else{for(let x=mnx;x<=mxx;x++){pts.push([x,mny]);if(mny!==mxy)pts.push([x,mxy]);}for(let y=mny+1;y<mxy;y++){pts.push([mnx,y]);if(mnx!==mxx)pts.push([mxx,y]);}}
  return pts;
}
function ellPts(x0,y0,x1,y1){
  const cx=(x0+x1)/2,cy=(y0+y1)/2,rx=Math.abs(x1-x0)/2,ry=Math.abs(y1-y0)/2;
  const seen=new Set(),pts=[];
  if(shapeFill){
    for(let y=Math.floor(cy-ry);y<=Math.ceil(cy+ry);y++)
      for(let x=Math.floor(cx-rx);x<=Math.ceil(cx+rx);x++){
        const ddx=(x-cx)/(rx||.01),ddy=(y-cy)/(ry||.01);
        if(ddx*ddx+ddy*ddy<=1.05){const k=x+','+y;if(!seen.has(k)){seen.add(k);pts.push([x,y]);}}
      }
  } else {
    for(let a=0;a<720;a++){const rad=a*Math.PI/360;const x=Math.round(cx+rx*Math.cos(rad));const y=Math.round(cy+ry*Math.sin(rad));const k=x+','+y;if(!seen.has(k)){seen.add(k);pts.push([x,y]);}}
  }
  return pts;
}
function getShPrev(c){
  if(!shapeStart||!c)return[];
  if(tool==='line')return bres(shapeStart.x,shapeStart.y,c.x,c.y);
  if(tool==='rect')return rectPts(shapeStart.x,shapeStart.y,c.x,c.y);
  if(tool==='ellipse')return ellPts(shapeStart.x,shapeStart.y,c.x,c.y);
  return[];
}
function commitSh(c){
  if(!shapeStart||!c)return;
  const pts=getShPrev(c);
  pts.forEach(([x,y])=>{if(x>=0&&x<W&&y>=0&&y<H)pixels[y][x]=color;});
  if(pts.length)addUsed(color);
  shapeStart=null;shapePreview=[];pushH();render();
}
function flood(x,y,target,fill){
  if(target===fill)return;
  const stack=[[x,y]],seen=new Set();
  while(stack.length){const[cx,cy]=stack.pop(),k=cx+','+cy;if(seen.has(k)||cx<0||cx>=W||cy<0||cy>=H||pixels[cy][cx]!==target)continue;seen.add(k);pixels[cy][cx]=fill;stack.push([cx+1,cy],[cx-1,cy],[cx,cy+1],[cx,cy-1]);}
}
function setColor(h){
  if(!/^#[0-9a-fA-F]{6}$/.test(h))return;
  color=h;
  document.getElementById('tcp').value=h;
  document.getElementById('thex').textContent=h.toUpperCase();
  document.getElementById('tcol').style.background=h;
  document.querySelectorAll('.bwc').forEach(d=>d.classList.toggle('on',d.title.toLowerCase()===h.toLowerCase()));
  document.querySelectorAll('.palc').forEach(d=>d.classList.toggle('on',d.title.toLowerCase()===h.toLowerCase()));
}
function addUsed(h){
  if(!usedColors.includes(h)){
    usedColors.unshift(h);if(usedColors.length>64)usedColors.pop();
    renderPal();document.getElementById('st-cols').textContent=usedColors.length;
  }
}
function renderPal(){
  const g=document.getElementById('palg');
  if(!usedColors.length){g.innerHTML='<div class="pale">‚Äî wybierz kolor ‚Äî</div>';return;}
  g.innerHTML='';
  usedColors.forEach(h=>{
    const d=document.createElement('div');
    d.className='palc'+(h.toLowerCase()===color.toLowerCase()?' on':'');
    d.style.background=h;d.title=h.toUpperCase();d.onclick=()=>setColor(h);
    g.appendChild(d);
  });
}
function clearPal(){usedColors=[];renderPal();document.getElementById('st-cols').textContent=0;}
function sortPal(){usedColors.sort((a,b)=>parseInt(b.slice(1),16)-parseInt(a.slice(1),16));renderPal();}
async function screenPick(){
  if(!window.EyeDropper){alert('Twoja przeglƒÖdarka nie obs≈Çuguje zbieracza.\nU≈ºyj Chrome 95+ lub Edge 95+.');return;}
  try{const ed=new EyeDropper();const r=await ed.open();setColor(r.sRGBHex);addUsed(r.sRGBHex);}catch(e){}
}
function onExtDrop(e){e.preventDefault();const f=e.dataTransfer.files[0];if(f&&f.type.startsWith('image/'))loadExtImg(f);}
function loadExtImg(file){
  if(!file)return;
  const r=new FileReader();r.onload=ev=>{
    const img=new Image();img.onload=()=>{
      extImgEl=img;
      document.getElementById('extinn').innerHTML=`<img class="eprev" src="${ev.target.result}"><div class="ds">kliknij aby zmieniƒá</div>`;
      document.getElementById('extctrl').style.display='block';
    };img.src=ev.target.result;
  };r.readAsDataURL(file);
}
function chEC(d){extCount=Math.max(4,Math.min(64,extCount+d));document.getElementById('ecnt').textContent=extCount;}
function extractColors(){
  if(!extImgEl)return;
  const sz=80,cv=document.createElement('canvas');cv.width=sz;cv.height=sz;
  const ctx=cv.getContext('2d');ctx.drawImage(extImgEl,0,0,sz,sz);
  const data=ctx.getImageData(0,0,sz,sz).data,map={};
  for(let i=0;i<data.length;i+=4){
    if(data[i+3]<100)continue;
    const r=Math.round(data[i]/32)*32,g=Math.round(data[i+1]/32)*32,b=Math.round(data[i+2]/32)*32;
    const k=`${Math.min(255,r)},${Math.min(255,g)},${Math.min(255,b)}`;map[k]=(map[k]||0)+1;
  }
  const extr=Object.entries(map).sort((a,b)=>b[1]-a[1]).slice(0,extCount).map(([k])=>{
    const[r,g,b]=k.split(',').map(Number);return'#'+[r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('');
  });
  let added=0;extr.forEach(h=>{if(!usedColors.includes(h)){usedColors.push(h);added++;}});
  if(usedColors.length>64)usedColors=usedColors.slice(0,64);
  renderPal();document.getElementById('st-cols').textContent=usedColors.length;
  const btn=document.getElementById('extbtn');
  btn.textContent=`‚úì DODANO ${added} KOLOR√ìW`;btn.className='actb ok';
  setTimeout(()=>{btn.textContent='WYCIƒÑGNIJ KOLORY';btn.className='actb';},2200);
}
function onRefDrop(e){e.preventDefault();const f=e.dataTransfer.files[0];if(f&&f.type.startsWith('image/'))loadRefImg(f);}
function loadRefImg(file){
  if(!file)return;
  const r=new FileReader();r.onload=ev=>{
    const o=document.getElementById('refimg');o.src=ev.target.result;o.style.display='block';
    document.getElementById('refinn').innerHTML=`<img src="${ev.target.result}" style="width:100%;height:42px;object-fit:cover;display:block;margin-bottom:3px"><div class="ds">kliknij aby zmieniƒá</div>`;
    document.getElementById('refctrl').style.display='block';updRef();
  };r.readAsDataURL(file);
}
function updRef(){
  const o=document.getElementById('refimg');if(o.style.display==='none')return;
  const sz=document.getElementById('rfsz').value,op=document.getElementById('rfop').value;
  document.getElementById('rfszv').textContent=sz;document.getElementById('rfopv').textContent=op+'%';
  o.style.width=sz+'px';o.style.height='auto';o.style.opacity=op/100;posRef();
}
function setRP(p){
  refPos=p;document.querySelectorAll('.posb').forEach(b=>b.classList.remove('on'));
  document.getElementById('pos-'+p).classList.add('on');posRef();
}
function posRef(){
  const o=document.getElementById('refimg'),pad=12;
  o.style.top='';o.style.left='';o.style.bottom='';o.style.right='';
  if(refPos==='tl'){o.style.top=pad+'px';o.style.left=pad+'px';}
  else if(refPos==='tr'){o.style.top=pad+'px';o.style.right=pad+'px';}
  else if(refPos==='bl'){o.style.bottom=pad+'px';o.style.left=pad+'px';}
  else{o.style.bottom=pad+'px';o.style.right=pad+'px';}
}
function removeRef(){
  const o=document.getElementById('refimg');o.style.display='none';o.src='';
  document.getElementById('refinn').innerHTML=`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg><div class="dt">WGRAJ WZORZEC</div><div class="ds">pojawi siƒô w rogu ekranu</div>`;
  document.getElementById('refctrl').style.display='none';
}
function applySize(){
  const nw=Math.max(1,Math.min(256,parseInt(document.getElementById('inpw').value)||16));
  const nh=Math.max(1,Math.min(256,parseInt(document.getElementById('inph').value)||16));
  pixels=Array.from({length:nh},(_,y)=>Array.from({length:nw},(_,x)=>(y<H&&x<W)?pixels[y][x]:''));
  W=nw;H=nh;fitZ();pushH();updStatus();render();
}
function setSize(w,h){document.getElementById('inpw').value=w;document.getElementById('inph').value=h;applySize();}
function fitZ(){
  const a=document.getElementById('cva');
  const fw=Math.floor((a.clientWidth-40)/W),fh=Math.floor((a.clientHeight-40)/H);
  const fit=Math.min(fw,fh,64);
  zIdx=ZOOMS.reduce((pi,z,i)=>Math.abs(z-fit)<Math.abs(ZOOMS[pi]-fit)?i:pi,0);
  ZOOM=ZOOMS[zIdx];
  document.getElementById('tzv').textContent=ZOOM+'√ó';
  document.getElementById('st-zoom').textContent=ZOOM+'√ó';
}
function chZoom(d){
  zIdx=Math.max(0,Math.min(ZOOMS.length-1,zIdx+d));ZOOM=ZOOMS[zIdx];
  document.getElementById('tzv').textContent=ZOOM+'√ó';
  document.getElementById('st-zoom').textContent=ZOOM+'√ó';render();
}
function setZ1(){zIdx=0;ZOOM=1;document.getElementById('tzv').textContent='1√ó';document.getElementById('st-zoom').textContent='1√ó';render();}
function newCanvas(){if(confirm('Nowe p≈Ç√≥tno? Zmiany zostanƒÖ utracone.')){pixels=mk(W,H);pushH();render();}}
function flipH(){pixels=pixels.map(r=>[...r].reverse());pushH();render();}
function flipV(){pixels=[...pixels].reverse();pushH();render();}
function rot90(){
  const np=mk(H,W);
  for(let y=0;y<H;y++)for(let x=0;x<W;x++)np[x][H-1-y]=pixels[y][x];
  [W,H]=[H,W];pixels=np;
  document.getElementById('inpw').value=W;document.getElementById('inph').value=H;
  pushH();updStatus();render();
}
function invertColors(){
  const inv=h=>{if(!h)return'';const r=255-parseInt(h.slice(1,3),16),g=255-parseInt(h.slice(3,5),16),b=255-parseInt(h.slice(5,7),16);return'#'+[r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('');};
  pixels=pixels.map(row=>row.map(c=>c?inv(c):''));pushH();render();
}
function toggleFill(){
  shapeFill=!shapeFill;
  document.getElementById('fillitem').firstChild.textContent=`Tryb kszta≈Çtu: ${shapeFill?'WYPE≈ÅNIONY':'OBRAMOWANIE'}`;
}
function exportPNG(){
  const cv=document.createElement('canvas');cv.width=W;cv.height=H;
  const ctx=cv.getContext('2d');ctx.clearRect(0,0,W,H);
  for(let y=0;y<H;y++)for(let x=0;x<W;x++)if(pixels[y][x]){ctx.fillStyle=pixels[y][x];ctx.fillRect(x,y,1,1);}
  cv.toBlob(b=>{const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=`xfazi_${W}x${H}.png`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u);},'image/png');
}
function exportBig(){
  const S=4,cv=document.createElement('canvas');cv.width=W*S;cv.height=H*S;
  const ctx=cv.getContext('2d');ctx.imageSmoothingEnabled=false;ctx.clearRect(0,0,W*S,H*S);
  for(let y=0;y<H;y++)for(let x=0;x<W;x++)if(pixels[y][x]){ctx.fillStyle=pixels[y][x];ctx.fillRect(x*S,y*S,S,S);}
  cv.toBlob(b=>{const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=`xfazi_${W}x${H}_x4.png`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u);},'image/png');
}
function clearCanvas(){if(confirm('Wyczy≈õciƒá ca≈Çe p≈Ç√≥tno?')){pixels=mk(W,H);pushH();render();}}
function updStatus(){
  document.getElementById('st-size').textContent=`${W}√ó${H}`;
  document.getElementById('st-zoom').textContent=ZOOM+'√ó';
  document.getElementById('tzv').textContent=ZOOM+'√ó';
}
const CV=document.getElementById('px');
CV.addEventListener('mousedown',e=>{
  if(e.button!==0)return;const c=cellAt(e);if(!c)return;
  if(tool==='line'||tool==='rect'||tool==='ellipse'){shapeStart={...c};shapePreview=[[c.x,c.y]];render();}
  else{painting=true;applyAt(c.x,c.y);lastCell=c;}
});
CV.addEventListener('mousemove',e=>{
  const c=cellAt(e);
  document.getElementById('st-pos').textContent=c?`${c.x}, ${c.y}`:'‚Äî';
  if((tool==='line'||tool==='rect'||tool==='ellipse')&&shapeStart&&c){shapePreview=getShPrev(c);render();return;}
  if(!painting||!c)return;
  if(tool==='pencil'||tool==='eraser'){if(!lastCell||lastCell.x!==c.x||lastCell.y!==c.y){applyAt(c.x,c.y);lastCell=c;}}
});
CV.addEventListener('mouseup',e=>{
  if(tool==='line'||tool==='rect'||tool==='ellipse'){const c=cellAt(e);commitSh(c||shapeStart);}
  else if(painting){painting=false;lastCell=null;if(tool==='pencil'||tool==='eraser'||tool==='fill')pushH();}
});
CV.addEventListener('mouseleave',()=>{document.getElementById('st-pos').textContent='‚Äî';});
document.getElementById('cva').addEventListener('wheel',e=>{e.preventDefault();chZoom(e.deltaY<0?1:-1);},{passive:false});
window.addEventListener('keydown',e=>{
  if(e.target.tagName==='INPUT')return;
  if(e.key==='p'||e.key==='P')setTool('pencil');
  if(e.key==='e'||e.key==='E')setTool('eraser');
  if(e.key==='f'||e.key==='F')setTool('fill');
  if(e.key==='i'||e.key==='I')setTool('eyedropper');
  if(e.key==='l'||e.key==='L')setTool('line');
  if(e.key==='r'||e.key==='R')setTool('rect');
  if(e.key==='o'||e.key==='O')setTool('ellipse');
  if(e.key==='?')openTut();
  if(e.key==='0'){fitZ();render();}
  if(e.key==='1')setZ1();
  if(e.key==='+'||e.key==='=')chZoom(1);
  if(e.key==='-')chZoom(-1);
  if(e.key==='Escape'){const i=document.getElementById('intro');if(i.style.display!=='none')skipIntro();}
  if((e.ctrlKey||e.metaKey)&&!e.shiftKey&&(e.key==='z'||e.key==='Z')){e.preventDefault();undo();}
  if((e.ctrlKey||e.metaKey)&&(e.key==='y'||e.key==='Y')){e.preventDefault();redo();}
  if((e.ctrlKey||e.metaKey)&&e.shiftKey&&(e.key==='z'||e.key==='Z')){e.preventDefault();redo();}
  if((e.ctrlKey||e.metaKey)&&(e.key==='s'||e.key==='S')){e.preventDefault();exportPNG();}
  if((e.ctrlKey||e.metaKey)&&(e.key==='n'||e.key==='N')){e.preventDefault();newCanvas();}
});
init();
window.addEventListener('load',()=>setTimeout(()=>{fitZ();render();},80));
</script>
</body>
</html>
